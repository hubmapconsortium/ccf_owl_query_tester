id: cells_by_marker
description: This tests all cells expressing marker Z

input:
  markers:
    - http://identifiers.org/hgnc/6445

expected_result:
  cell:
    - http://purl.obolibrary.org/obo/CL_0000033
    - http://purl.obolibrary.org/obo/CL_0000523
    - http://purl.obolibrary.org/obo/CL_0000244
    - http://purl.obolibrary.org/obo/CL_0002536
    - http://purl.obolibrary.org/obo/CL_0000434
    - http://purl.obolibrary.org/obo/CL_0008036
    - http://purl.obolibrary.org/obo/CL_0000525
    - http://purl.obolibrary.org/obo/CL_0000240
    - http://purl.obolibrary.org/obo/CL_0008036
    - http://purl.obolibrary.org/obo/CL_0000241
    - http://purl.obolibrary.org/obo/CL_0000317
    - http://purl.obolibrary.org/obo/CL_0000146
    - http://purl.obolibrary.org/obo/CL_0000738

query_mechanism:
  ccf:
    query: "PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX has_characterizing_marker_set: <http://purl.obolibrary.org/obo/RO_0015004>
      PREFIX marker_component: <http://purl.org/ccf/has_marker_component>

      SELECT ?cell
      WHERE {
        VALUES ?marker {
          markers
        }
        ?cell rdfs:subClassOf [ 
          owl:onProperty has_characterizing_marker_set: ;
          owl:someValuesFrom [
            owl:intersectionOf/rdf:rest*/rdf:first [
              owl:onProperty marker_component: ;
              owl:someValuesFrom ?marker 
            ]
          ] 
        ] .
      }
    "
